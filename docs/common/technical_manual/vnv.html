<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>2. Verification and Validation</title>
    
      <link rel="stylesheet" href="../../_static/pygments.css">
      <link rel="stylesheet" href="../../_static/theme.css">
      <link rel="stylesheet" href="../../_static/sphinx_press_theme.css">
          <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
      
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/custom.js"></script>
        <script type="text/javascript" src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

      
      <script src="../../_static/theme-vendors.js"></script>
      <script src="../../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="next" title="1. How to Extend" href="../developer_manual/how_to_extend/how_to_extend.html" />
  <link rel="prev" title="1. Theory and Implementation" href="theory.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../../index.html" class="home-link">
    
      <img class="logo" src="../../_static/SimCenter_SURF_logo.png" alt="doit logo"/>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="../../index.html#what-is-appname"
         class="nav-link ">
         User Manual
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#what-is-appname"
         class="nav-link  router-link-active">
         Technical Manual
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#what-is-appname"
         class="nav-link ">
         Developer Manual
      </a>
    </div>
  



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="../../index.html#what-is-appname"
         class="nav-link ">
         User Manual
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#what-is-appname"
         class="nav-link  router-link-active">
         Technical Manual
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../../index.html#what-is-appname"
         class="nav-link ">
         Developer Manual
      </a>
    </div>
  



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#what-is-appname">User Manual</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../license.html" class="reference internal ">Copyright and license</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../user_manual/installation/installation.html" class="reference internal ">Installation</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../user_manual/usage/tutorial.html" class="reference internal ">Tutorial</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../user_manual/bugs.html" class="reference internal ">Bugs & Feauture Requests</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#what-is-appname">Technical Manual</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="theory.html" class="reference internal ">Theory and Implementation</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">Verification and Validation</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#anchorage-building-dataset" class="reference internal">Anchorage building dataset</a></li>
                
              </ul>
            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#what-is-appname">Developer Manual</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../developer_manual/how_to_extend/how_to_extend.html" class="reference internal ">How to Extend</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../developer_manual/coding_style/coding_style.html" class="reference internal ">Coding Style</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
          
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
    
    <li><span class="section-number">2. </span>Verification and Validation</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="theory.html"
       title="previous chapter">← <span class="section-number">1. </span>Theory and Implementation</a>
  </li>
  <li class="next">
    <a href="../developer_manual/how_to_extend/how_to_extend.html"
       title="next chapter"><span class="section-number">1. </span>How to Extend →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  <div class="section" id="verification-and-validation">
<span id="lbl-vnv"></span><h1><span class="section-number">2. </span>Verification and Validation<a class="headerlink" href="#verification-and-validation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="anchorage-building-dataset">
<h2><span class="section-number">2.1. </span>Anchorage building dataset<a class="headerlink" href="#anchorage-building-dataset" title="Permalink to this headline">¶</a></h2>
<p>This section shows an example in which a neural network is built and trained on the building dataset of Anchorage.
For each building, the location coordinates (longitude, latitude) and year of construction can be found in the dataset.
In this example, 80% of the building were taken for training. The left 20% buildings are used for testing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">wget</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>

<span class="c1">#---------------------------------------------------------------------------------------</span>
<span class="c1"># 0. Download data</span>
<span class="c1">#---------------------------------------------------------------------------------------</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://berkeley.box.com/shared/static/jbvyu0ng0zrt75il3ps1qygwellpr8c5.zip&#39;</span>
<span class="n">workDir</span> <span class="o">=</span> <span class="s1">&#39;tmp&#39;</span>
<span class="n">fileName</span> <span class="o">=</span> <span class="s1">&#39;AnchorageBuildings.zip&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Beginning file download with wget module&#39;</span><span class="p">)</span>
<span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">fileName</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File downloaded. </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
    <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">dest</span> <span class="o">=</span> <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">workDir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">workDir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">fileName</span><span class="p">)</span>
    <span class="n">dest</span> <span class="o">=</span> <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">workDir</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>


<span class="c1">#---------------------------------------------------------------------------------------</span>
<span class="c1"># 1. Prepare data</span>
<span class="c1">#---------------------------------------------------------------------------------------</span>

<span class="n">BIMFileName</span> <span class="o">=</span> <span class="s1">&#39;tmp/AnchorageBuildings.csv&#39;</span>

<span class="c1"># read raw data</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">BIMFileName</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">])</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">])</span>
        <span class="n">yearbuilt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Year Built&#39;</span><span class="p">])</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">lat</span><span class="o">&gt;</span><span class="mf">61.05</span> <span class="ow">and</span> <span class="n">lat</span><span class="o">&lt;</span><span class="mf">61.2</span> <span class="ow">and</span> <span class="n">lon</span><span class="o">&gt;-</span><span class="mf">150.</span> <span class="ow">and</span> <span class="n">lon</span><span class="o">&lt;-</span><span class="mf">149.7</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">yearbuilt</span><span class="p">])</span>

<span class="c1"># data is a numpy matrix with columns: [x,y,value]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="c1">#---------------------------------------------------------------------------------------</span>
<span class="c1"># 2. Train a neural network</span>
<span class="c1">#---------------------------------------------------------------------------------------</span>
<span class="kn">from</span> <span class="nn">surf.NN</span> <span class="kn">import</span> <span class="n">SpatialNeuralNet</span>


<span class="c1"># define a spatial neural network</span>
<span class="c1"># numNei is the number of nearest neighbors to be considered</span>
<span class="c1"># writeTmpData is true so that temporary files are written down in ./tmp</span>
<span class="n">nn</span> <span class="o">=</span> <span class="n">SpatialNeuralNet</span><span class="p">(</span><span class="n">rawData</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">numNei</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">writeTmpData</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">nn</span><span class="o">.</span><span class="n">build_model</span><span class="p">()</span>
<span class="n">nn</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>


<span class="c1">#---------------------------------------------------------------------------------------</span>
<span class="c1"># 3. Test the neural network</span>
<span class="c1">#---------------------------------------------------------------------------------------</span>

<span class="n">nn</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
</pre></div>
</div>
<p>The above example can run locally on your computer if you’ve installed pySURF.
However, a convenient way to quickly test the example is to run it on Google Colab.
Click <a class="reference external" href="https://colab.research.google.com/github/NHERI-SimCenter/SURF/blob/master/examples/demo-NN.ipynb">this link</a> to run on Google Colab.</p>
<p>Upon the complete of the modeling, the prediction errors will be plotted, such as the one shown in</p>
<div class="align-center figure" id="id1">
<span id="error-demo"></span><img alt="../../_images/Predictions_error_Anchorage.png" src="../../_images/Predictions_error_Anchorage.png" />
<p class="caption"><span class="caption-number">Fig. 2.1.1 </span><span class="caption-text">Prediction errors for the parameter: year of construction of buildings in Anchorage</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="theory.html"
       title="previous chapter">← <span class="section-number">1. </span>Theory and Implementation</a>
  </li>
  <li class="next">
    <a href="../developer_manual/how_to_extend/how_to_extend.html"
       title="next chapter"><span class="section-number">1. </span>How to Extend →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2020, NHERI SimCenter.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a>.

</div>


            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>